<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Green Report</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
        }

        .tab-button {
            flex: 1;
            padding: 20px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            color: #6c757d;
            transition: all 0.3s ease;
            position: relative;
        }

        .tab-button:hover {
            background: rgba(79, 172, 254, 0.1);
            color: #4facfe;
        }

        .tab-button.active {
            color: #4facfe;
            background: white;
        }

        .tab-button.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .tab-content {
            display: none;
            padding: 40px;
            min-height: 500px;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .action-section {
            margin-bottom: 30px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #4facfe;
        }

        .action-section h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-right: 10px;
            margin-bottom: 10px;
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(79, 172, 254, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .data-display {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            min-height: 150px;
        }

        .data-display h4 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .data-item {
            background: #f8f9fa;
            padding: 10px 15px;
            margin-bottom: 10px;
            border-radius: 6px;
            border-left: 3px solid #4facfe;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: #6c757d;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #4facfe;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .api-log {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            max-height: 200px;
            overflow-y: auto;
        }

        .api-log .log-entry {
            margin-bottom: 5px;
            padding: 5px;
            border-radius: 3px;
        }

        .api-log .log-entry.success {
            background: rgba(46, 204, 113, 0.2);
        }

        .api-log .log-entry.error {
            background: rgba(231, 76, 60, 0.2);
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>üß™ API Duplicate Test Site</h1>
            <p>Test site for detecting duplicate API calls in UI tests</p>
        </div>

        <div class="tabs">
            <button class="tab-button active" data-tab="tab1" data-testid="tab1-button">
                üìä Single Calls Tab
            </button>
            <button class="tab-button" data-tab="tab2" data-testid="tab2-button">
                üîÑ One Duplicate Tab
            </button>
            <button class="tab-button" data-tab="tab3" data-testid="tab3-button">
                ‚ö° Multiple Duplicates Tab
            </button>
        </div>

        <div id="tab1" class="tab-content active">
            <div class="action-section">
                <h3>üéØ Tab 1: Clean API Calls (No Duplicates)</h3>
                <p>This tab makes unique API calls without any duplicates.</p>
                <button class="btn" data-testid="load-users-btn">Load Users</button>
                <button class="btn" data-testid="load-posts-btn">Load Posts</button>
                <button class="btn" data-testid="load-settings-btn">Load Settings</button>
            </div>

            <div class="data-display" data-testid="tab1-content">
                <h4>üìã Content Display</h4>
                <div id="tab1-data"></div>
                <div class="loading" id="tab1-loading">
                    <div class="spinner"></div>
                    Loading data...
                </div>
            </div>

            <div class="api-log" data-testid="tab1-log">
                <strong>üîç API Call Log:</strong>
                <div id="tab1-log-content"></div>
            </div>
        </div>

        <div id="tab2" class="tab-content">
            <div class="action-section">
                <h3>‚ö†Ô∏è Tab 2: One Duplicate Call</h3>
                <p>This tab will make one duplicate API call when you interact with it.</p>
                <button class="btn" data-testid="load-profile-btn">Load Profile</button>
                <button class="btn" data-testid="refresh-profile-btn">Refresh Profile (Duplicate!)</button>
                <button class="btn" data-testid="load-notifications-btn">Load Notifications</button>
            </div>

            <div class="data-display" data-testid="tab2-content">
                <h4>üë§ Profile & Notifications</h4>
                <div id="tab2-data"></div>
                <div class="loading" id="tab2-loading">
                    <div class="spinner"></div>
                    Loading data...
                </div>
            </div>

            <div class="api-log" data-testid="tab2-log">
                <strong>üîç API Call Log:</strong>
                <div id="tab2-log-content"></div>
            </div>
        </div>

        <div id="tab3" class="tab-content">
            <div class="action-section">
                <h3>üö® Tab 3: Multiple Duplicates</h3>
                <p>This tab will make multiple duplicate calls to test the detection system.</p>
                <button class="btn" data-testid="load-analytics-btn">Load Analytics</button>
                <button class="btn" data-testid="refresh-analytics-btn">Refresh Analytics</button>
                <button class="btn" data-testid="reload-analytics-btn">Reload Analytics</button>
                <button class="btn" data-testid="load-reports-btn">Load Reports</button>
                <button class="btn" data-testid="refresh-reports-btn">Refresh Reports</button>
            </div>

            <div class="data-display" data-testid="tab3-content">
                <h4>üìà Analytics & Reports</h4>
                <div id="tab3-data"></div>
                <div class="loading" id="tab3-loading">
                    <div class="spinner"></div>
                    Loading data...
                </div>
            </div>

            <div class="api-log" data-testid="tab3-log">
                <strong>üîç API Call Log:</strong>
                <div id="tab3-log-content"></div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let apiCallCount = 0;

        // Tab switching functionality
        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', () => {
                const tabId = button.dataset.tab;

                // Remove active class from all tabs and buttons
                document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));

                // Add active class to clicked button and corresponding tab
                button.classList.add('active');
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Mock API function
        async function makeApiCall(endpoint, tabId) {
            console.log(`[API_CALL] ${endpoint}`);
            const logElement = document.getElementById(`${tabId}-log-content`);
            const loadingElement = document.getElementById(`${tabId}-loading`);

            // Show loading
            loadingElement.style.display = 'block';

            // Log the API call
            const timestamp = new Date().toLocaleTimeString();
            logElement.innerHTML += `<div class="log-entry">[${timestamp}] GET ${endpoint}</div>`;
            logElement.scrollTop = logElement.scrollHeight;

            try {
                let data;
                // Use real JSONPlaceholder endpoints for /users and /posts, mock data for others
                if (endpoint === '/users' || endpoint === '/posts') {
                    const response = await fetch(`https://jsonplaceholder.typicode.com${endpoint}`);
                    data = await response.json();
                } else {
                    // Use mock data for custom endpoints
                    data = getMockData(endpoint);
                }

                // Hide loading
                loadingElement.style.display = 'none';

                // Log success
                logElement.innerHTML += `<div class="log-entry success">[${timestamp}] ‚úÖ Success: ${endpoint}</div>`;
                logElement.scrollTop = logElement.scrollHeight;

                return data;
            } catch (error) {
                // Hide loading
                loadingElement.style.display = 'none';

                // Log error
                logElement.innerHTML += `<div class="log-entry error">[${timestamp}] ‚ùå Error: ${endpoint}</div>`;
                logElement.scrollTop = logElement.scrollHeight;

                // Return mock data for testing
                return getMockData(endpoint);
            }
        }

        // Mock data generator
        function getMockData(endpoint) {
            const mockData = {
                '/users': [
                    { id: 1, name: 'John Doe', email: 'john@example.com' },
                    { id: 2, name: 'Jane Smith', email: 'jane@example.com' }
                ],
                '/posts': [
                    { id: 1, title: 'First Post', body: 'This is the first post content' },
                    { id: 2, title: 'Second Post', body: 'This is the second post content' }
                ],
                '/settings': {
                    theme: 'dark',
                    notifications: true,
                    language: 'en'
                },
                '/profile': {
                    id: 1,
                    name: 'Current User',
                    avatar: 'üë§',
                    role: 'Admin'
                },
                '/notifications': [
                    { id: 1, message: 'New message received', read: false },
                    { id: 2, message: 'System update completed', read: true }
                ],
                '/analytics': {
                    visitors: 1234,
                    pageViews: 5678,
                    bounceRate: '45%'
                },
                '/reports': [
                    { name: 'Monthly Report', size: '2.4MB', date: '2024-01-15' },
                    { name: 'Weekly Summary', size: '856KB', date: '2024-01-22' }
                ]
            };

            return mockData[endpoint] || { message: 'Mock data for ' + endpoint };
        }

        // Display data function
        function displayData(data, tabId) {
            const dataElement = document.getElementById(`${tabId}-data`);

            if (Array.isArray(data)) {
                dataElement.innerHTML = data.map(item =>
                    `<div class="data-item">${JSON.stringify(item, null, 2)}</div>`
                ).join('');
            } else {
                dataElement.innerHTML = `<div class="data-item">${JSON.stringify(data, null, 2)}</div>`;
            }
        }

        // Tab 1 Event Listeners - No Duplicates
        document.querySelector('[data-testid="load-users-btn"]').addEventListener('click', async () => {
            const data = await makeApiCall('/users', 'tab1');
            displayData(data, 'tab1');
        });

        document.querySelector('[data-testid="load-posts-btn"]').addEventListener('click', async () => {
            const data = await makeApiCall('/posts', 'tab1');
            displayData(data, 'tab1');
        });

        document.querySelector('[data-testid="load-settings-btn"]').addEventListener('click', async () => {
            const data = await makeApiCall('/settings', 'tab1');
            displayData(data, 'tab1');
        });

        // Tab 2 Event Listeners - One Duplicate
        document.querySelector('[data-testid="load-profile-btn"]').addEventListener('click', async () => {
            const data = await makeApiCall('/profile', 'tab2');
            displayData(data, 'tab2');
        });

        document.querySelector('[data-testid="refresh-profile-btn"]').addEventListener('click', async () => {
            // This creates a duplicate call to /profile
            const data = await makeApiCall('/profile', 'tab2');
            displayData(data, 'tab2');
        });

        document.querySelector('[data-testid="load-notifications-btn"]').addEventListener('click', async () => {
            const data = await makeApiCall('/notifications', 'tab2');
            displayData(data, 'tab2');
        });

        // Tab 3 Event Listeners - Multiple Duplicates
        document.querySelector('[data-testid="load-analytics-btn"]').addEventListener('click', async () => {
            const data = await makeApiCall('/analytics', 'tab3');
            displayData(data, 'tab3');
        });

        document.querySelector('[data-testid="refresh-analytics-btn"]').addEventListener('click', async () => {
            // Duplicate call to /analytics (2nd time)
            const data = await makeApiCall('/analytics', 'tab3');
            displayData(data, 'tab3');
        });

        document.querySelector('[data-testid="reload-analytics-btn"]').addEventListener('click', async () => {
            // Duplicate call to /analytics (3rd time)
            const data = await makeApiCall('/analytics', 'tab3');
            displayData(data, 'tab3');
        });

        document.querySelector('[data-testid="load-reports-btn"]').addEventListener('click', async () => {
            const data = await makeApiCall('/reports', 'tab3');
            displayData(data, 'tab3');
        });

        document.querySelector('[data-testid="refresh-reports-btn"]').addEventListener('click', async () => {
            // Duplicate call to /reports (2nd time)
            const data = await makeApiCall('/reports', 'tab3');
            displayData(data, 'tab3');
        });

        // Initialize with some welcome message
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('tab1-data').innerHTML =
                '<div class="data-item">üéØ Ready to test! Click buttons above to make API calls.</div>';
            document.getElementById('tab2-data').innerHTML =
                '<div class="data-item">‚ö†Ô∏è This tab will create duplicate API calls.</div>';
            document.getElementById('tab3-data').innerHTML =
                '<div class="data-item">üö® This tab will create multiple duplicates.</div>';
        });
    </script>
</body>

</html>